### Intro

本章总结了一两种常用的线程模型，归纳了进程间通信与线程同步的最佳实践，以期用简单规范的方式开发功能正确、线程安全的多线程程序

### 进程与线程

chenshuo将进程比作人，将独立的address space比作memory，对于分布式系统当中的一些功能，有了拟人化的理解
- 容错：万一有人突然挂了
- 扩容：新人突然加进来
- 负载均衡：把甲的活挪给乙做
- 退休：甲要修复bug，先别给他派活

线程的特点是共享地址空间，从而可以高效地共享数据。一台机器上的多个进程能高效地共享代码段（操作系统可以映射为同样的物理内存），但不能共享数据。
如果多个进程大量共享内存，等于是把多进程程序当成多线程来写，掩耳盗铃。

这里结合我们初代的推荐系统，彼时通过共享内存的方式支持索引，来达到共享数据的目的。一个cpu挂一个进程，固然代码好写也高效，但经常出现死锁，不就是这个问题嘛。所以后来，大家意识到这种设计的不足，才做了服务化。

chenshuo关于多线程的观点如下：
>"多线程"的价值，我认为是为了更好地发挥多核处理器（multi-cores）的效能。在单核时代，多线程没有多大价值.
Alan Cox 说过："A computer is a state machine.Threads are for people who can’t program state machines.
如果只有一块CPU、一个执行单元，那么确实如Alan Cox 所说，按状态机的思路去写程序是最高效的.